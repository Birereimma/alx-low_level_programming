This code is about More functions, more nested loops
